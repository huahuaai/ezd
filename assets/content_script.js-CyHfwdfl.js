let c=(e,s)=>{s.includes("图片")&&chrome.runtime.sendMessage({getImportBtn:!0},async t=>{console.log(t);let o=t.import_btn_string;const n=document.createElement("div");n.innerHTML=o;let i=n.querySelector(".import_btn_container");n.querySelector(".import_btn").addEventListener("click",p);let l=document.querySelector(".weui-desktop-global-mod > .weui-desktop-global__extra");l.style.position="relative",l.insertBefore(i,l.firstChild)}),e.includes("素材库")&&chrome.runtime.sendMessage({getOpenspBtn:!0},async t=>{const o=document.createElement("div");o.innerHTML=t.opensp_btn_string;let n=o.querySelector(".opensp_btn_container");n.style.position="fixed",n.style.right="0px",n.style.top="50%",n.style.transform="translateY(-50%)",n.style.padding="0px",n.style.zIndex="1000",console.log(n),o.querySelector(".opensp_btn").addEventListener("click",m),document.body.appendChild(n)})};chrome.runtime.sendMessage({docloaded:!0},async e=>{console.log(e),e.wxTabId;let s=document.querySelector(".weui-desktop-block__title").textContent,t=document.querySelector(".weui-desktop-panel__title").textContent;c(s,t)});let r=new Map,p=()=>{document.querySelectorAll(".weui-desktop-img-picker__item_selected").forEach(t=>{let o=t.querySelector(".weui-desktop-img-picker__img-thumb").style.backgroundImage.match(/url\("?(.*?)"?\)/)[1],n=t.querySelector(".weui-desktop-img-picker__img-title").textContent,i=o.split("/")[4];r.set(i,{imgurl:o,imgtitle:n})});let s=[];r.forEach((t,o)=>{console.log(t),s.push({type:"img",key:o,imgurl:t.imgurl,imgtitle:t.imgtitle})}),chrome.runtime.sendMessage({imginfoList:s},t=>{console.log("I send it success")})},m=()=>{chrome.runtime.sendMessage({opensidepanel:!0})},d=()=>{let e=document.querySelector(".opensp_btn");e.style.transition="transform 0.5s ease-in-out",e.style.transform="translateX(0)",setTimeout(()=>{e.style.transform="translateX(100%)"},0)},u=()=>{let e=document.querySelector(".opensp_btn");e.style.transition="transform 0.5s ease-in-out",e.style.transform="translateX(100%)",setTimeout(()=>{e.style.transform="translateX(0)"},0)},a=chrome.runtime.connect({name:"getSidePanelStatus"});console.log(a);a.onMessage.addListener(e=>{e.spopen?(console.log("aaa"),d()):e.spclose&&(console.log("bbb"),u())});
