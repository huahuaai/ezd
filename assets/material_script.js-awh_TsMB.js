import{s as N}from"./utils-C4Bj6WAK.js";const z=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function D(t){return typeof t=="string"&&z.test(t)}function H(t){if(!D(t))throw TypeError("Invalid UUID");var n,e=new Uint8Array(16);return e[0]=(n=parseInt(t.slice(0,8),16))>>>24,e[1]=n>>>16&255,e[2]=n>>>8&255,e[3]=n&255,e[4]=(n=parseInt(t.slice(9,13),16))>>>8,e[5]=n&255,e[6]=(n=parseInt(t.slice(14,18),16))>>>8,e[7]=n&255,e[8]=(n=parseInt(t.slice(19,23),16))>>>8,e[9]=n&255,e[10]=(n=parseInt(t.slice(24,36),16))/1099511627776&255,e[11]=n/4294967296&255,e[12]=n>>>24&255,e[13]=n>>>16&255,e[14]=n>>>8&255,e[15]=n&255,e}var a=[];for(var L=0;L<256;++L)a.push((L+256).toString(16).slice(1));function O(t,n=0){return(a[t[n+0]]+a[t[n+1]]+a[t[n+2]]+a[t[n+3]]+"-"+a[t[n+4]]+a[t[n+5]]+"-"+a[t[n+6]]+a[t[n+7]]+"-"+a[t[n+8]]+a[t[n+9]]+"-"+a[t[n+10]]+a[t[n+11]]+a[t[n+12]]+a[t[n+13]]+a[t[n+14]]+a[t[n+15]]).toLowerCase()}function R(t){t=unescape(encodeURIComponent(t));for(var n=[],e=0;e<t.length;++e)n.push(t.charCodeAt(e));return n}var B="6ba7b810-9dad-11d1-80b4-00c04fd430c8",P="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function F(t,n,e){function s(m,b,d,u){var c;if(typeof m=="string"&&(m=R(m)),typeof b=="string"&&(b=H(b)),((c=b)===null||c===void 0?void 0:c.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var g=new Uint8Array(16+m.length);if(g.set(b),g.set(m,b.length),g=e(g),g[6]=g[6]&15|n,g[8]=g[8]&63|128,d){u=u||0;for(var h=0;h<16;++h)d[u+h]=g[h];return d}return O(g)}try{s.name=t}catch{}return s.DNS=B,s.URL=P,s}function G(t,n,e,s){switch(t){case 0:return n&e^~n&s;case 1:return n^e^s;case 2:return n&e^n&s^e&s;case 3:return n^e^s}}function A(t,n){return t<<n|t>>>32-n}function K(t){var n=[1518500249,1859775393,2400959708,3395469782],e=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){var s=unescape(encodeURIComponent(t));t=[];for(var m=0;m<s.length;++m)t.push(s.charCodeAt(m))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var b=t.length/4+2,d=Math.ceil(b/16),u=new Array(d),c=0;c<d;++c){for(var g=new Uint32Array(16),h=0;h<16;++h)g[h]=t[c*64+h*4]<<24|t[c*64+h*4+1]<<16|t[c*64+h*4+2]<<8|t[c*64+h*4+3];u[c]=g}u[d-1][14]=(t.length-1)*8/Math.pow(2,32),u[d-1][14]=Math.floor(u[d-1][14]),u[d-1][15]=(t.length-1)*8&4294967295;for(var E=0;E<d;++E){for(var w=new Uint32Array(80),v=0;v<16;++v)w[v]=u[E][v];for(var y=16;y<80;++y)w[y]=A(w[y-3]^w[y-8]^w[y-14]^w[y-16],1);for(var _=e[0],x=e[1],r=e[2],l=e[3],i=e[4],o=0;o<80;++o){var f=Math.floor(o/20),p=A(_,5)+G(f,x,r,l)+i+n[f]+w[o]>>>0;i=l,l=r,r=A(x,30)>>>0,x=_,_=p}e[0]=e[0]+_>>>0,e[1]=e[1]+x>>>0,e[2]=e[2]+r>>>0,e[3]=e[3]+l>>>0,e[4]=e[4]+i>>>0}return[e[0]>>24&255,e[0]>>16&255,e[0]>>8&255,e[0]&255,e[1]>>24&255,e[1]>>16&255,e[1]>>8&255,e[1]&255,e[2]>>24&255,e[2]>>16&255,e[2]>>8&255,e[2]&255,e[3]>>24&255,e[3]>>16&255,e[3]>>8&255,e[3]&255,e[4]>>24&255,e[4]>>16&255,e[4]>>8&255,e[4]&255]}var C=F("v5",80,K);const V=C("ezdrop.cn",C.DNS),X=t=>C(t,V);let Y='<div class="import_btn_container" style="font-weight:600;padding:2px 15px 2px 15px;border-radius:4px;position:absolute;right: 125px;background-color:#12A3FF;color:white;transition: all .2s;">导入ezDrop<div style="position: absolute;margin-top: -35px;text-align: right;width: 100px;"><span class="import_btn_circle_of_number" style="display: inline-block;line-height: 18px;color: white;background-color: #e97170;text-align: right;border-radius: 28px;height: 18px;padding: 0px 6px;box-sizing: border-box;font-size: 12px;white-space: nowrap;">0</span></div>',Z=`<div class="opensp_btn_container" style="padding:0px;margin:0px">
<button type="button" class="opensp_btn" style="padding:0px;margin:0px">
  <svg style="dispaly:block;" width="66" height="258" viewBox="0 0 66 258" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g>
      <path id="elastic-path" fill-rule="evenodd" clip-rule="evenodd" d="M66,48.6 C66,95.2,22,95.2,22,122 C22,148.8,66,148.8,66,195.4 V48.6z" class="cls-1"/>
    </g>
	<defs>
	  <style>
	    .cls-1 {
	      fill: url(#gradient_1);
	    }
	  </style>
	  <linearGradient id="gradient_1" x1="22" y1="0" x2="66" y2="0" gradientTransform="translate(0 -755.19) scale(1 1.31)" gradientUnits="userSpaceOnUse">
	    <stop offset="0" stop-color="#54e3ff"/>
	    <stop offset=".5" stop-color="#30c0ff"/>
	    <stop offset="1" stop-color="#12a3ff"/>
	  </linearGradient>
	</defs>
    <path id="arrow-path" d="M46.2,132.7c-0.7,0-1.3-0.3-1.8-0.8l-7.7-7.7c-1-1-1-2.6,0-3.6l7.6-7.6c1-1,2.6-1,3.6,0c1,1,1,2.6,0,3.6l-5.8,5.8l5.9,5.9c1,1,1,2.6,0,3.6C47.5,132.4,46.9,132.7,46.2,132.7z" fill="white" />
    </svg>
</button>
</div>`;const T=()=>{k.style.transform="translate(100%,-50%)",k.style.transition="transform 0.5s ease-in-out"},$=()=>{k.style.transform="translate(0,-50%)",k.style.transition="transform 0.5s ease-in-out"};let M=chrome.runtime.connect({name:"material_contentjs"});M.onMessage.addListener(function(t,n,e){t.open?(console.log("sidepanel open"),T()):t.close?(console.log("sidepanel close"),$()):t.init?(console.log("material_contentjs init"),M.postMessage({isOpen:!0})):t.isopen&&T()});let q=()=>{chrome.runtime.sendMessage({opensidepanel:!0})};const I=document.createElement("div");I.innerHTML=Z;let k=I.querySelector(".opensp_btn_container");k.style.position="fixed";k.style.right="0px";k.style.top="50%";k.style.transform="translateY(-50%)";k.style.padding="0px";k.style.zIndex="10000";let J=I.querySelector(".opensp_btn");J.addEventListener("click",q);document.body.appendChild(k);let U=document.querySelector(".weui-desktop-panel__title")?document.querySelector(".weui-desktop-panel__title").textContent:"";console.log(U);if(U.includes("图片")){let t=new Map,n=document.querySelector(".weui-desktop-global__info .weui-desktop-form__checkbox"),e=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-form__checkbox"),s=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-img-picker__img-thumb"),m=(r,l)=>{let i=r.querySelector(".weui-desktop-img-picker__img-thumb").style.backgroundImage.match(/url\("?(.*?)"?\)/)[1].split("/")[4]+l+r.querySelector(".weui-desktop-img-picker__img-title").textContent;return i=X(i),i},b=(r,l)=>{let i=r.querySelector(".weui-desktop-img-picker__img-thumb").style.backgroundImage.match(/url\("?(.*?)"?\)/)[1],o=r.querySelector(".weui-desktop-img-picker__img-title").textContent,f=m(r,l);t.set(f,{imgurl:i,imgtitle:o})},d=(r,l)=>i=>{if(i.target.checked)b(r,l);else{let p=m(r,l);t.delete(p),setTimeout(()=>{t.size!=0&&(x.style.display="block")},500)}document.querySelector(".weui-desktop-global__info a").style.setProperty("display","none","important");let f=document.querySelectorAll(".weui-desktop-btn_mini");if(t.size!=0){t.size<=999?y.innerHTML=t.size:t.size>999&&(y.innerHTML="999+");for(let p=0;p<f.length;p++)f[p].addEventListener("click",function S(){setTimeout(()=>{t.size!==0&&(x.style.display="block",this.removeEventListener("click",S))},500)})}else{y.innerHTML=t.size,setTimeout(()=>{x.style.display="none"},500);for(let p=0;p<f.length;p++)f[p].addEventListener("click",function S(){setTimeout(()=>{x.style.display="none",this.removeEventListener("click",S)},500)})}},u=[],c=[];n.addEventListener("change",r=>{e.forEach((l,i)=>{let o=l.parentNode.parentNode;d(o,i)(r)})});for(let r=0;r<s.length;r++){let l=i=>{e[r].dispatchEvent(new Event("change")),e[r].dispatchEvent(new Event("change"))};s[r].addEventListener("click",l),c.push(l)}e.forEach((r,l)=>{let i=r.parentNode.parentNode,o=d(i,l);u.push(o),r.addEventListener("change",o)});const g=new MutationObserver(r=>{console.log("mutations",r);for(let i=0;i<e.length;++i)e[i].removeEventListener("change",u[i]),s[i].removeEventListener("click",c[i]);u=[],c=[],e=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-form__checkbox");let l=0;e.forEach((i,o)=>{let f=i.parentNode.parentNode,p=m(f,o);t.has(p)&&(l++,i.click())}),l===e.length&&n.click(),s=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-img-picker__img-thumb"),e=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-form__checkbox"),e.forEach((i,o)=>{let f=i.parentNode.parentNode,p=d(f,o);u.push(p),i.addEventListener("change",p)});for(let i=0;i<s.length;i++){let o=f=>{console.log(n[i]),e[i].dispatchEvent(new Event("change")),e[i].dispatchEvent(new Event("change"))};s[i].addEventListener("click",o),c.push(o)}}),h=document.querySelectorAll(".weui-desktop-img-picker__img-thumb"),E={attributes:!0,subtree:!0};h.forEach(r=>{g.observe(r,E)});const w=document.createElement("div");w.innerHTML=Y;let v=w.querySelector(".import_btn_container"),y=v.querySelector("span"),_=()=>{let r=[];t.forEach((i,o)=>{const f=new Date().getTime();r.push({type:"img",key:o+f,imgurl:i.imgurl,imgtitle:i.imgtitle})}),r.sort((i,o)=>i.imgtitle.localeCompare(o.imgtitle)),q(),t.clear(),N("importedImgInfoList",r),document.querySelectorAll(".weui-desktop-global__info > a")[0].click()};v.addEventListener("click",_),v.addEventListener("mouseenter",r=>{v.style.cursor="pointer",v.style.backgroundColor="rgba(18, 163, 255, 0.533)"}),v.addEventListener("mouseleave",r=>{v.style.backgroundColor="#12A3FF"});let x=document.querySelector(".weui-desktop-global-mod");x.style.position="relative",x.insertBefore(v,x.firstChild)}
