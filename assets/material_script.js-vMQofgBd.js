let S='<div class="import_btn_container" style="font-weight:500;padding:2px 10px 2px 10px;border-radius:4px;width: 95;height: 30;position:absolute;right: 125px;background-color:#007AFF;color:white">导入列表</div>',L=`<div class="opensp_btn_container" style="padding:0px;margin:0px">
<button type="button" class="opensp_btn" style="padding:0px;margin:0px">
  <svg width="59" height="258" viewBox="0 0 59 258" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g filter="url(#filter0_d_98_7145)">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M22.0002 122.026C22.0002 100.681 48.9534 86.1105 56.5706 66.1713L59.5995 58.243C85.903 -10.6103 188.052 8.23686 188.052 81.9434L188.052 161.459C188.052 235.493 85.4496 254.424 59.0293 185.265L56.0688 177.515C48.5105 157.73 22.0002 143.205 22.0002 122.026Z" fill="#007AFF"/>
    </g>
    <path d="M34.5791 121.949C34.5791 122.19 34.6279 122.415 34.7256 122.623C34.8167 122.825 34.9632 123.023 35.165 123.219L42.5381 130.445C42.8376 130.745 43.2021 130.895 43.6318 130.895C43.9118 130.895 44.1722 130.823 44.4131 130.68C44.654 130.543 44.846 130.357 44.9893 130.123C45.126 129.889 45.1943 129.628 45.1943 129.342C45.1943 128.912 45.0283 128.528 44.6963 128.189L38.2607 121.939L44.6963 115.699C45.0283 115.374 45.1943 114.993 45.1943 114.557C45.1943 114.27 45.126 114.01 44.9893 113.775C44.846 113.541 44.654 113.355 44.4131 113.219C44.1722 113.076 43.9118 113.004 43.6318 113.004C43.2021 113.004 42.8376 113.15 42.5381 113.443L35.165 120.67C34.9632 120.865 34.8167 121.067 34.7256 121.275C34.6344 121.477 34.5856 121.702 34.5791 121.949Z" fill="white" fill-opacity="0.5"/>
    <defs>
    <filter id="filter0_d_98_7145" x="0.000244141" y="0.456055" width="210.052" height="256.785" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
    <feFlood flood-opacity="0" result="BackgroundImageFix"/>
    <feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha"/>
    <feOffset dy="7"/>
    <feGaussianBlur stdDeviation="11"/>
    <feComposite in2="hardAlpha" operator="out"/>
    <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0"/>
    <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_98_7145"/>
    <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_98_7145" result="shape"/>
    </filter>
    </defs>
    </svg>
</button>
</div>`,v=()=>{chrome.runtime.sendMessage({opensidepanel:!0})};const _=document.createElement("div");_.innerHTML=L;let n=_.querySelector(".opensp_btn_container");n.style.position="fixed";n.style.right="0px";n.style.top="50%";n.style.transform="translateY(-50%)";n.style.padding="0px";n.style.zIndex="10000";let q=_.querySelector(".opensp_btn");q.addEventListener("click",v);document.body.appendChild(n);let y=document.querySelector(".weui-desktop-panel__title")?document.querySelector(".weui-desktop-panel__title").textContent:"";console.log(y);if(y.includes("图片")){let s=new Map,k=document.querySelector(".weui-desktop-global__info .weui-desktop-form__checkbox"),l=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-form__checkbox"),r=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-img-picker__img-thumb"),m=(t,o)=>t.querySelector(".weui-desktop-img-picker__img-thumb").style.backgroundImage.match(/url\("?(.*?)"?\)/)[1].split("/")[4]+o+t.querySelector(".weui-desktop-img-picker__img-title").textContent,w=(t,o)=>{let e=t.querySelector(".weui-desktop-img-picker__img-thumb").style.backgroundImage.match(/url\("?(.*?)"?\)/)[1],i=t.querySelector(".weui-desktop-img-picker__img-title").textContent,c=m(t,o);s.set(c,{imgurl:e,imgtitle:i})},g=(t,o)=>e=>{if(e.target.checked)w(t,o);else{let i=m(t,o);s.delete(i)}},d=[],p=[];k.addEventListener("change",t=>{l.forEach((o,e)=>{let i=o.parentNode.parentNode;g(i,e)(t)})});for(let t=0;t<r.length;t++){let o=e=>{l[t].dispatchEvent(new Event("change")),l[t].dispatchEvent(new Event("change"))};r[t].addEventListener("click",o),p.push(o)}l.forEach((t,o)=>{let e=t.parentNode.parentNode,i=g(e,o);d.push(i),t.addEventListener("change",i)});const b=new MutationObserver(t=>{for(let e=0;e<l.length;++e)l[e].removeEventListener("change",d[e]),r[e].removeEventListener("click",p[e]);d=[],p=[],l=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-form__checkbox");let o=0;l.forEach((e,i)=>{let c=e.parentNode.parentNode,u=m(c,i);s.has(u)&&(o++,e.click())}),o===l.length&&k.click(),r=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-img-picker__img-thumb"),l=document.querySelectorAll(".weui-desktop-img-picker__item .weui-desktop-form__checkbox"),l.forEach((e,i)=>{let c=e.parentNode.parentNode,u=g(c,i);d.push(u),e.addEventListener("change",u)});for(let e=0;e<r.length;e++){let i=c=>{l[e].dispatchEvent(new Event("change")),l[e].dispatchEvent(new Event("change"))};r[e].addEventListener("click",i),p.push(i)}}),C=document.querySelectorAll(".weui-desktop-img-picker__img-thumb"),x={attributes:!0,subtree:!0};C.forEach(t=>{b.observe(t,x)});const f=document.createElement("div");f.innerHTML=S;let a=f.querySelector(".import_btn_container"),E=()=>{let t=[];s.forEach((e,i)=>{t.push({type:"img",key:i,imgurl:e.imgurl,imgtitle:e.imgtitle})}),t.sort((e,i)=>e.imgtitle.localeCompare(i.imgtitle)),v(),s.clear(),setTimeout(()=>{chrome.runtime.sendMessage({imginfoList:t},e=>{console.log("I send it success")})},888),document.querySelectorAll(".weui-desktop-global__info > a")[0].click()};a.addEventListener("click",E),a.addEventListener("mouseenter",()=>{a.style.cursor="pointer"});let h=document.querySelector(".weui-desktop-global-mod");h.style.position="relative",h.insertBefore(a,h.firstChild)}
